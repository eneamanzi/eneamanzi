name: Metrics
on:
  # Schedule daily updates
  schedule: [{cron: "0 0 * * *"}]
  # (optional) Run workflow manually
  workflow_dispatch:
  # (optional) Run workflow when pushing on master/main
  push: {branches: ["master", "main"]}
jobs:
  github-metrics:
    runs-on: ubuntu-latest
    environment: 
      name: production
    permissions:
      contents: write
    steps:
      # --- 1. Statistiche Base (per "users accounts") ---
      # Genera il file: base.svg
      - name: Generate Base Stats
        uses: lowlighter/metrics@latest
        with:
          filename: base.svg
          token: ${{ secrets.METRICS_TOKEN }}
          config_timezone: Europe/Rome
          # Plugin abilitati: solo "base" (che Ã¨ quello di default)
          base: header, activity, community,  repositories, metadata # Puoi personalizzare quali sezioni base mostrare
          repositories_skipped: Esercizi-Asmeta

      ## --- 2. Achievements ---
      ## Genera il file: achievements.svg
      #- name: Generate Achievements
      #  uses: lowlighter/metrics@latest
      #  with:
      #    filename: achievements.svg
      #    token: ${{ secrets.METRICS_TOKEN }}
      #    config_timezone: Europe/Rome
      #    base: ""  # Nascondiamo le statistiche base in questo file
      #    plugin_achievements: yes
      #    plugin_achievements_display: compact
          

      # --- 3. Top Languages ---
      # Genera il file: languages.svg
      - name: Generate Top Languages
        uses: lowlighter/metrics@latest
        with:
          filename: languages.svg
          token: ${{ secrets.METRICS_TOKEN }}
          config_timezone: Europe/Rome
          base: ""
          plugin_languages: yes
          plugin_languages_limit: 8
          # Aggiungi qui le repo da ignorare, se vuoi
          repositories_skipped: Esercizi-Asmeta

      ## --- 4. GitHub Skyline ---
      ## Genera il file: skyline.svg
      #- name: Generate Skyline
      #  uses: lowlighter/metrics@latest
      #  with:
      #    filename: skyline.svg
      #    token: ${{ secrets.METRICS_TOKEN }}
      #    config_timezone: Europe/Rome
      #    base: ""
      #    plugin_skyline: yes
      #    plugin_skyline_year: 2025
      #    plugin_skyline_frames: 6
      #    plugin_skyline_quality: 1
      #    repositories_skipped: Esercizi-Asmeta